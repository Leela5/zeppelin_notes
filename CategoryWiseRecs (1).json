{"paragraphs":[{"text":"%spark2.pyspark\n# Recommendation system on Ecommerce category data\n\n# events data\nevents = spark.read.options(header=True, inferSchema=True).csv('/user/capstone/events.csv')\n","user":"anonymous","dateUpdated":"2018-07-28T13:11:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532783375082_687131157","id":"20180728-130935_1078269635","dateCreated":"2018-07-28T13:09:35+0000","dateStarted":"2018-07-28T13:11:31+0000","dateFinished":"2018-07-28T13:13:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:111"},{"text":"%spark2.pyspark\nevents.count()\n","user":"anonymous","dateUpdated":"2018-07-28T13:12:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2756101\n"}]},"apps":[],"jobName":"paragraph_1532783491668_-841122122","id":"20180728-131131_682817216","dateCreated":"2018-07-28T13:11:31+0000","dateStarted":"2018-07-28T13:12:00+0000","dateFinished":"2018-07-28T13:13:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"%spark2.pyspark\nevents.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:12:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+---------+-----+------+-------------+\n|    timestamp|visitorid|event|itemid|transactionid|\n+-------------+---------+-----+------+-------------+\n|1433221332117|   257597| view|355908|         null|\n|1433224214164|   992329| view|248676|         null|\n|1433221999827|   111016| view|318965|         null|\n|1433221955914|   483717| view|253185|         null|\n|1433221337106|   951259| view|367447|         null|\n+-------------+---------+-----+------+-------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783520637_1272516480","id":"20180728-131200_964416062","dateCreated":"2018-07-28T13:12:00+0000","dateStarted":"2018-07-28T13:13:34+0000","dateFinished":"2018-07-28T13:13:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%spark2.pyspark\n# Drop timestamp and transactionid as a part of cleaning NAs and noise coulmn in events data\n\nevents_clean = events.drop('timestamp', 'transactionid')\n","user":"anonymous","dateUpdated":"2018-07-28T13:12:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532783533054_-253012909","id":"20180728-131213_196407991","dateCreated":"2018-07-28T13:12:13+0000","dateStarted":"2018-07-28T13:13:44+0000","dateFinished":"2018-07-28T13:13:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"text":"%spark2.pyspark\nevents_clean.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:12:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+------+\n|visitorid|event|itemid|\n+---------+-----+------+\n|   257597| view|355908|\n|   992329| view|248676|\n|   111016| view|318965|\n|   483717| view|253185|\n|   951259| view|367447|\n+---------+-----+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783544294_-727762403","id":"20180728-131224_1529329919","dateCreated":"2018-07-28T13:12:24+0000","dateStarted":"2018-07-28T13:13:52+0000","dateFinished":"2018-07-28T13:13:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"text":"%spark2.pyspark\n# item data\n\nitem1 = spark.read.options(header=True,inferSchema=True).csv('/user/capstone/item_properties_part1.csv')","user":"anonymous","dateUpdated":"2018-07-28T13:13:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532783569355_-1313888220","id":"20180728-131249_1425631611","dateCreated":"2018-07-28T13:12:49+0000","dateStarted":"2018-07-28T13:13:52+0000","dateFinished":"2018-07-28T13:14:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"text":"%spark2.pyspark\nitem1.show(5)\n","user":"anonymous","dateUpdated":"2018-07-28T13:16:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------+----------+--------------------+\n|    timestamp|itemid|  property|               value|\n+-------------+------+----------+--------------------+\n|1435460400000|460429|categoryid|                1338|\n|1441508400000|206783|       888|1116713 960601 n2...|\n|1439089200000|395014|       400|n552.000 639502 n...|\n|1431226800000| 59481|       790|          n15360.000|\n|1431831600000|156781|       917|              828513|\n+-------------+------+----------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783585754_978861124","id":"20180728-131305_1403141687","dateCreated":"2018-07-28T13:13:05+0000","dateStarted":"2018-07-28T13:16:19+0000","dateFinished":"2018-07-28T13:16:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"text":"%spark2.pyspark\n\nitem1.count()","user":"anonymous","dateUpdated":"2018-07-28T13:16:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10999999\n"}]},"apps":[],"jobName":"paragraph_1532783606518_239773811","id":"20180728-131326_1888267838","dateCreated":"2018-07-28T13:13:26+0000","dateStarted":"2018-07-28T13:16:21+0000","dateFinished":"2018-07-28T13:16:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"%spark2.pyspark\nitem2 = spark.read.options(header=True,inferSchema=True).csv('/user/capstone/item_properties_part2.csv')\n\nitem2.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:16:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------+--------+---------------+\n|    timestamp|itemid|property|          value|\n+-------------+------+--------+---------------+\n|1433041200000|183478|     561|         769062|\n|1439694000000|132256|     976|n26.400 1135780|\n|1435460400000|420307|     921|1149317 1257525|\n|1431831600000|403324|     917|        1204143|\n|1435460400000|230701|     521|         769062|\n+-------------+------+--------+---------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783622390_-1571993435","id":"20180728-131342_1985985091","dateCreated":"2018-07-28T13:13:42+0000","dateStarted":"2018-07-28T13:16:31+0000","dateFinished":"2018-07-28T13:17:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"%spark2.pyspark\nitem2.count()","user":"anonymous","dateUpdated":"2018-07-28T13:18:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9275903\n"}]},"apps":[],"jobName":"paragraph_1532783650529_-1070018714","id":"20180728-131410_1494456530","dateCreated":"2018-07-28T13:14:10+0000","dateStarted":"2018-07-28T13:18:35+0000","dateFinished":"2018-07-28T13:19:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"%spark2.pyspark\nitem = item1.unionAll(item2)\n\nitem.count()","user":"anonymous","dateUpdated":"2018-07-28T13:18:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"20275902\n"}]},"apps":[],"jobName":"paragraph_1532783667479_-1608267101","id":"20180728-131427_1204785932","dateCreated":"2018-07-28T13:14:27+0000","dateStarted":"2018-07-28T13:18:37+0000","dateFinished":"2018-07-28T13:20:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%spark2.pyspark\nitem.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:19:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------+----------+--------------------+\n|    timestamp|itemid|  property|               value|\n+-------------+------+----------+--------------------+\n|1435460400000|460429|categoryid|                1338|\n|1441508400000|206783|       888|1116713 960601 n2...|\n|1439089200000|395014|       400|n552.000 639502 n...|\n|1431226800000| 59481|       790|          n15360.000|\n|1431831600000|156781|       917|              828513|\n+-------------+------+----------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783685528_134291316","id":"20180728-131445_1209312132","dateCreated":"2018-07-28T13:14:45+0000","dateStarted":"2018-07-28T13:19:15+0000","dateFinished":"2018-07-28T13:20:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"%spark2.pyspark\n# Select items only with categoryid\n\nitemsWithCategory = item[item.property == 'categoryid']","user":"anonymous","dateUpdated":"2018-07-28T13:20:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532783704798_-1138241863","id":"20180728-131504_1541459394","dateCreated":"2018-07-28T13:15:04+0000","dateStarted":"2018-07-28T13:20:03+0000","dateFinished":"2018-07-28T13:20:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%spark2.pyspark\nitemsWithCategory.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:20:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------+----------+-----+\n|    timestamp|itemid|  property|value|\n+-------------+------+----------+-----+\n|1435460400000|460429|categoryid| 1338|\n|1432436400000|281245|categoryid| 1277|\n|1435460400000| 35575|categoryid| 1059|\n|1437274800000|  8313|categoryid| 1147|\n|1437879600000| 55102|categoryid|   47|\n+-------------+------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783713406_-253688817","id":"20180728-131513_1647318596","dateCreated":"2018-07-28T13:15:13+0000","dateStarted":"2018-07-28T13:20:13+0000","dateFinished":"2018-07-28T13:20:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"%spark2.pyspark\nitemsWithCategory.count()","user":"anonymous","dateUpdated":"2018-07-28T13:22:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"788214\n"}]},"apps":[],"jobName":"paragraph_1532783733952_1658943938","id":"20180728-131533_102297606","dateCreated":"2018-07-28T13:15:33+0000","dateStarted":"2018-07-28T13:22:11+0000","dateFinished":"2018-07-28T13:23:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"%spark2.pyspark\n# itemsWithCategory groupBy items with max timestamp\n\nitemsWithCategoryidMaxTimestamp = itemsWithCategory.groupBy('itemid').max('timestamp')","user":"anonymous","dateUpdated":"2018-07-28T13:22:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532783753613_1738217535","id":"20180728-131553_1200889632","dateCreated":"2018-07-28T13:15:53+0000","dateStarted":"2018-07-28T13:22:12+0000","dateFinished":"2018-07-28T13:23:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"%spark2.pyspark\nitemsWithCategoryidMaxTimestamp.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:23:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------+\n|itemid|max(timestamp)|\n+------+--------------+\n| 30903| 1442113200000|\n|114206| 1431226800000|\n| 56987| 1431226800000|\n|205270| 1431226800000|\n|376650| 1442113200000|\n+------+--------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783767960_-2015995310","id":"20180728-131607_1130522852","dateCreated":"2018-07-28T13:16:07+0000","dateStarted":"2018-07-28T13:23:03+0000","dateFinished":"2018-07-28T13:24:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"%spark2.pyspark\n\nitemsWithCategoryidMaxTimestamp.count()","user":"anonymous","dateUpdated":"2018-07-28T13:23:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"417053\n"}]},"apps":[],"jobName":"paragraph_1532783790481_628045104","id":"20180728-131630_1762695468","dateCreated":"2018-07-28T13:16:30+0000","dateStarted":"2018-07-28T13:23:03+0000","dateFinished":"2018-07-28T13:25:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"text":"%spark2.pyspark\n# Rename the max(timestamp) as timestamp to join with itemsWithCategory\n\nitem_time = itemsWithCategoryidMaxTimestamp.toDF('itemid','timestamp')\n\nitem_time.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:24:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------------+\n|itemid|    timestamp|\n+------+-------------+\n| 30903|1442113200000|\n|114206|1431226800000|\n| 56987|1431226800000|\n|205270|1431226800000|\n|376650|1442113200000|\n+------+-------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783816920_424543584","id":"20180728-131656_2085927376","dateCreated":"2018-07-28T13:16:56+0000","dateStarted":"2018-07-28T13:24:07+0000","dateFinished":"2018-07-28T13:26:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129"},{"text":"%spark2.pyspark\nitem_time.count()","user":"anonymous","dateUpdated":"2018-07-28T13:25:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"417053\n"}]},"apps":[],"jobName":"paragraph_1532783830425_-246226991","id":"20180728-131710_1082970954","dateCreated":"2018-07-28T13:17:10+0000","dateStarted":"2018-07-28T13:25:29+0000","dateFinished":"2018-07-28T13:27:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:130"},{"text":"%spark2.pyspark\n# Join the itemsWithCategory and item_time\n\nitemsWithMaxTimestamCategory = itemsWithCategory.join(item_time, ['itemid','timestamp'])\n\nitemsWithMaxTimestamCategory.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:26:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------------+----------+-----+\n|itemid|    timestamp|  property|value|\n+------+-------------+----------+-----+\n|   261|1433041200000|categoryid|  816|\n|   682|1433041200000|categoryid|  217|\n|   715|1433041200000|categoryid|  403|\n|   925|1431226800000|categoryid|  959|\n|  1101|1442113200000|categoryid| 1244|\n+------+-------------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783906939_2127981851","id":"20180728-131826_1116097400","dateCreated":"2018-07-28T13:18:26+0000","dateStarted":"2018-07-28T13:26:28+0000","dateFinished":"2018-07-28T13:30:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:131"},{"text":"%spark2.pyspark\nitemsWithMaxTimestamCategory.count()","user":"anonymous","dateUpdated":"2018-07-28T13:27:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"417053\n"}]},"apps":[],"jobName":"paragraph_1532783940325_-2042665578","id":"20180728-131900_1757358870","dateCreated":"2018-07-28T13:19:00+0000","dateStarted":"2018-07-28T13:27:29+0000","dateFinished":"2018-07-28T13:33:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:132"},{"text":"%spark2.pyspark\n# Join the itemsWithMaxtimestampCategory with events data\n\neventItemsWithMaxtimestamCategory = events_clean.join(itemsWithMaxTimestamCategory, ['itemid'])\n\neventItemsWithMaxtimestamCategory.count()","user":"anonymous","dateUpdated":"2018-07-28T13:40:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2500516\n"}]},"apps":[],"jobName":"paragraph_1532783956394_-546530347","id":"20180728-131916_228720043","dateCreated":"2018-07-28T13:19:16+0000","dateStarted":"2018-07-28T13:40:44+0000","dateFinished":"2018-07-28T13:44:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:133"},{"text":"%spark2.pyspark\neventItemsWithMaxtimestamCategory.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:44:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-----+-------------+----------+-----+\n|itemid|visitorid|event|    timestamp|  property|value|\n+------+---------+-----+-------------+----------+-----+\n|   496|   198722| view|1431226800000|categoryid|  707|\n|   496|   198722| view|1431226800000|categoryid|  707|\n|   496|   198722| view|1431226800000|categoryid|  707|\n|   496|   580567| view|1431226800000|categoryid|  707|\n|   496|   566277| view|1431226800000|categoryid|  707|\n+------+---------+-----+-------------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532783969684_-210998658","id":"20180728-131929_892084042","dateCreated":"2018-07-28T13:19:29+0000","dateStarted":"2018-07-28T13:44:43+0000","dateFinished":"2018-07-28T13:48:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:134"},{"text":"%spark2.pyspark\n# Give values to variable event like view=1, addtocart=2,transaction=3\n\nview = eventItemsWithMaxtimestamCategory.replace({'view':'1'})\n\naddtocart = view.replace({'addtocart':'2'})\n\nCatVisitor = addtocart.replace({'transaction':'3'})\n\nCatVisitor.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:54:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-----+-------------+----------+-----+\n|itemid|visitorid|event|    timestamp|  property|value|\n+------+---------+-----+-------------+----------+-----+\n|   496|   198722|    1|1431226800000|categoryid|  707|\n|   496|   198722|    1|1431226800000|categoryid|  707|\n|   496|   198722|    1|1431226800000|categoryid|  707|\n|   496|   580567|    1|1431226800000|categoryid|  707|\n|   496|   566277|    1|1431226800000|categoryid|  707|\n+------+---------+-----+-------------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784037787_-31846877","id":"20180728-132037_868239631","dateCreated":"2018-07-28T13:20:37+0000","dateStarted":"2018-07-28T13:54:56+0000","dateFinished":"2018-07-28T13:59:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135"},{"text":"%spark2.pyspark\n# Rename the value variable as category and drop property column\n\nCatVisitor_1 = CatVisitor.drop('property')\n\nCatVisitor_1.show(2)","user":"anonymous","dateUpdated":"2018-07-28T14:00:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-----+-------------+-----+\n|itemid|visitorid|event|    timestamp|value|\n+------+---------+-----+-------------+-----+\n|   496|   198722|    1|1431226800000|  707|\n|   496|   198722|    1|1431226800000|  707|\n+------+---------+-----+-------------+-----+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784045490_1299399641","id":"20180728-132045_1719372842","dateCreated":"2018-07-28T13:20:45+0000","dateStarted":"2018-07-28T14:00:52+0000","dateFinished":"2018-07-28T14:04:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:136"},{"text":"%spark2.pyspark\nCatVisitor_2 = CatVisitor_1.toDF('itemid','visitorid','event','timestamp','categoryid')\n\nCatVisitor_2.show(2)","user":"anonymous","dateUpdated":"2018-07-28T14:07:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-----+-------------+----------+\n|itemid|visitorid|event|    timestamp|categoryid|\n+------+---------+-----+-------------+----------+\n|   496|   198722|    1|1431226800000|       707|\n|   496|   198722|    1|1431226800000|       707|\n+------+---------+-----+-------------+----------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784064377_-196488758","id":"20180728-132104_1258483765","dateCreated":"2018-07-28T13:21:04+0000","dateStarted":"2018-07-28T14:07:23+0000","dateFinished":"2018-07-28T14:11:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:137"},{"text":"%spark2.pyspark\n# Extract columns visitorid, categoryid and event to create recommender matrix\n\nCatVisitor_3 = CatVisitor_2['visitorid','categoryid','event']\n\nCatVisitor_3.show(2)","user":"anonymous","dateUpdated":"2018-07-28T14:17:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+----------+-----+\n|visitorid|categoryid|event|\n+---------+----------+-----+\n|   198722|       707|    1|\n|   198722|       707|    1|\n+---------+----------+-----+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784113363_1224281661","id":"20180728-132153_221187213","dateCreated":"2018-07-28T13:21:53+0000","dateStarted":"2018-07-28T14:17:59+0000","dateFinished":"2018-07-28T14:21:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:138"},{"text":"%spark2.pyspark\n\n# Drop duplicates-take distinct values\n\nfinal = CatVisitor_3.distinct()\n\nfinal.count()\n","user":"anonymous","dateUpdated":"2018-07-28T14:27:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1502956\n"}]},"apps":[],"jobName":"paragraph_1532784149280_408106650","id":"20180728-132229_183368461","dateCreated":"2018-07-28T13:22:29+0000","dateStarted":"2018-07-28T14:27:58+0000","dateFinished":"2018-07-28T14:32:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:139"},{"text":"%spark2.pyspark\n# Save finalMarix into hdfs\n\nfinal.coalesce(1).write.option('header','true').csv('/user/maria_dev/CategoryWiseRec.csv')","user":"anonymous","dateUpdated":"2018-07-28T14:37:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532784178245_808660904","id":"20180728-132258_253155462","dateCreated":"2018-07-28T13:22:58+0000","dateStarted":"2018-07-28T14:37:43+0000","dateFinished":"2018-07-28T14:41:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:140"},{"text":"%spark2.pyspark\n# Creating RDD file\n\ndata = sc.textFile('/user/maria_dev/CategoryWiseRec.csv')\n\ntype(data)\n","user":"anonymous","dateUpdated":"2018-07-28T14:43:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.RDD'>\n"}]},"apps":[],"jobName":"paragraph_1532784207798_-519446327","id":"20180728-132327_1981947526","dateCreated":"2018-07-28T13:23:27+0000","dateStarted":"2018-07-28T14:43:28+0000","dateFinished":"2018-07-28T14:43:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:141"},{"text":"%spark2.pyspark\ndata.first()","user":"anonymous","dateUpdated":"2018-07-28T14:43:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'visitorid,categoryid,event'\n"}]},"apps":[],"jobName":"paragraph_1532784236519_-950133588","id":"20180728-132356_1974892065","dateCreated":"2018-07-28T13:23:56+0000","dateStarted":"2018-07-28T14:43:35+0000","dateFinished":"2018-07-28T14:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:142"},{"text":"%spark2.pyspark\nheader=data.first()","user":"anonymous","dateUpdated":"2018-07-28T14:45:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532784290626_785139791","id":"20180728-132450_1709234945","dateCreated":"2018-07-28T13:24:50+0000","dateStarted":"2018-07-28T14:45:51+0000","dateFinished":"2018-07-28T14:45:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:143"},{"text":"%spark2.pyspark\n# Removing header from RDD data\n\ndataWithNoHeader = data.filter(lambda x: x!=header)\n\ndataWithNoHeader.first()","user":"anonymous","dateUpdated":"2018-07-28T14:45:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'1342555,707,1'\n"}]},"apps":[],"jobName":"paragraph_1532784325483_1834780763","id":"20180728-132525_1077906127","dateCreated":"2018-07-28T13:25:25+0000","dateStarted":"2018-07-28T14:45:58+0000","dateFinished":"2018-07-28T14:45:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:144"},{"text":"%spark2.pyspark\n# Load ALS module, MatrixFmapactorizationModel, Rating\n\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\n\n# .csv file\nCatRating = dataWithNoHeader.map(lambda x: x.split(','))\\\n.map(lambda x: Rating(int(x[0]), int(x[1]), float(x[2])))\n\nCatRating.take(5)","user":"anonymous","dateUpdated":"2018-07-28T14:46:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Rating(user=1342555, product=707, rating=1.0), Rating(user=244210, product=242, rating=1.0), Rating(user=1229304, product=1660, rating=1.0), Rating(user=672853, product=342, rating=1.0), Rating(user=1056465, product=921, rating=1.0)]\n"}]},"apps":[],"jobName":"paragraph_1532784357693_1227893830","id":"20180728-132557_647420891","dateCreated":"2018-07-28T13:25:57+0000","dateStarted":"2018-07-28T14:46:31+0000","dateFinished":"2018-07-28T14:46:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:145"},{"text":"%spark2.pyspark\ntype(CatRating)","user":"anonymous","dateUpdated":"2018-07-28T14:47:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532784398119_1267199515","id":"20180728-132638_1598955807","dateCreated":"2018-07-28T13:26:38+0000","dateStarted":"2018-07-28T14:47:01+0000","dateFinished":"2018-07-28T14:47:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:146"},{"text":"%spark2.pyspark\n# Data exploration on CatRating\n\ndf = sqlContext.createDataFrame(CatRating)","user":"anonymous","dateUpdated":"2018-07-28T14:49:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532784426496_782647408","id":"20180728-132706_1053535474","dateCreated":"2018-07-28T13:27:06+0000","dateStarted":"2018-07-28T14:49:13+0000","dateFinished":"2018-07-28T14:49:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:147"},{"text":"%spark2.pyspark\n# Distinct Users\n\ndf.select('user').distinct().show(5)","user":"anonymous","dateUpdated":"2018-07-28T14:49:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|   user|\n+-------+\n|1187945|\n| 993085|\n| 901600|\n|1030029|\n|1073116|\n+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784455669_-400794237","id":"20180728-132735_1189982336","dateCreated":"2018-07-28T13:27:35+0000","dateStarted":"2018-07-28T14:49:15+0000","dateFinished":"2018-07-28T14:49:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:148"},{"text":"%spark2.pyspark\n# Distinct Users's count\n\ndf.select('user').distinct().count()\n","user":"anonymous","dateUpdated":"2018-07-28T14:50:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1236032\n"}]},"apps":[],"jobName":"paragraph_1532784489255_-81205818","id":"20180728-132809_1662299949","dateCreated":"2018-07-28T13:28:09+0000","dateStarted":"2018-07-28T14:50:10+0000","dateFinished":"2018-07-28T14:50:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:149"},{"text":"%spark2.pyspark\n# distinct products # Category=product\n\ndf.select('product').distinct().count()\n","user":"anonymous","dateUpdated":"2018-07-28T14:53:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1086\n"}]},"apps":[],"jobName":"paragraph_1532784516396_-359348625","id":"20180728-132836_614719948","dateCreated":"2018-07-28T13:28:36+0000","dateStarted":"2018-07-28T14:51:58+0000","dateFinished":"2018-07-28T14:52:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:150"},{"text":"%spark2.pyspark\ndf.select('product').distinct().show(2)","user":"anonymous","dateUpdated":"2018-07-28T14:54:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|product|\n+-------+\n|    474|\n|     29|\n+-------+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532789538284_-80095973","id":"20180728-145218_704344687","dateCreated":"2018-07-28T14:52:18+0000","dateStarted":"2018-07-28T14:54:21+0000","dateFinished":"2018-07-28T14:55:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:151"},{"text":"%spark2.pyspark\n# GroupBy User\n\ndf.groupBy('user').count().take(2)","user":"anonymous","dateUpdated":"2018-07-28T14:55:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(user=1187945, count=1), Row(user=993085, count=1)]\n"}]},"apps":[],"jobName":"paragraph_1532784532581_1806433582","id":"20180728-132852_726075264","dateCreated":"2018-07-28T13:28:52+0000","dateStarted":"2018-07-28T14:55:32+0000","dateFinished":"2018-07-28T14:56:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:152"},{"text":"%spark2.pyspark\n# GroupBy User stats\n\ndf.groupBy('user').count().select('count').describe().show()\n","user":"anonymous","dateUpdated":"2018-07-28T14:57:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|             count|\n+-------+------------------+\n|  count|           1236032|\n|   mean| 1.215952337803552|\n| stddev|2.9331561296274162|\n|    min|                 1|\n|    max|               967|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1532784589405_465042386","id":"20180728-132949_1145638224","dateCreated":"2018-07-28T13:29:49+0000","dateStarted":"2018-07-28T14:57:12+0000","dateFinished":"2018-07-28T14:58:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:153"},{"text":"%spark2.pyspark\ndf.stat.crosstab('user','rating').show(2)","user":"anonymous","dateUpdated":"2018-07-28T15:03:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+---+---+---+\n|user_rating|1.0|2.0|3.0|\n+-----------+---+---+---+\n|     669325|  1|  0|  0|\n|     834212|  1|  0|  0|\n+-----------+---+---+---+\nonly showing top 2 rows\n\n"}]},"apps":[],"jobName":"paragraph_1532784605310_-1357882579","id":"20180728-133005_51732400","dateCreated":"2018-07-28T13:30:05+0000","dateStarted":"2018-07-28T15:03:41+0000","dateFinished":"2018-07-28T15:05:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:154"},{"text":"%spark2.pyspark\n## 1. Build the recommendation model using Alternating Least Squares\n\n# Splitting the CatRating data to apply ALS\n\n(training,test) = CatRating.randomSplit([0.8,0.2])\n\ntraining.count()","user":"anonymous","dateUpdated":"2018-07-28T15:06:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1202345\n"}]},"apps":[],"jobName":"paragraph_1532784616658_1421790307","id":"20180728-133016_1930486951","dateCreated":"2018-07-28T13:30:16+0000","dateStarted":"2018-07-28T15:06:40+0000","dateFinished":"2018-07-28T15:07:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:155"},{"text":"%spark2.pyspark\ntest.count()","user":"anonymous","dateUpdated":"2018-07-28T15:07:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"300611\n"}]},"apps":[],"jobName":"paragraph_1532784638354_-2000935908","id":"20180728-133038_694062908","dateCreated":"2018-07-28T13:30:38+0000","dateStarted":"2018-07-28T15:07:41+0000","dateFinished":"2018-07-28T15:08:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:156"},{"text":"%spark2.pyspark\n# Call the ALS.train mehod to train the model\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\n\nrank = 10\nnumIterations = 10\nmodel = model = ALS.trainImplicit(training, rank, numIterations, alpha=0.01)","user":"anonymous","dateUpdated":"2018-07-28T15:25:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1532784650697_-1325670940","id":"20180728-133050_232665932","dateCreated":"2018-07-28T13:30:50+0000","dateStarted":"2018-07-28T15:23:13+0000","dateFinished":"2018-07-28T15:25:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:157"},{"text":"%spark2.pyspark\nmodel","user":"anonymous","dateUpdated":"2018-07-28T15:25:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.mllib.recommendation.MatrixFactorizationModel object at 0x7fb12319b810>\n"}]},"apps":[],"jobName":"paragraph_1532784669933_1242173867","id":"20180728-133109_218922467","dateCreated":"2018-07-28T13:31:09+0000","dateStarted":"2018-07-28T15:25:57+0000","dateFinished":"2018-07-28T15:25:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:158"},{"text":"%spark2.pyspark\n# Evaluate the model on training data\n\ntestdata = test.map(lambda r: (r[0],r[1]))\n\ntype(testdata)","user":"anonymous","dateUpdated":"2018-07-28T15:28:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532784693341_-370077266","id":"20180728-133133_2068628980","dateCreated":"2018-07-28T13:31:33+0000","dateStarted":"2018-07-28T15:28:02+0000","dateFinished":"2018-07-28T15:28:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:159"},{"text":"%spark2.pyspark\ntestdata.take(5)","user":"anonymous","dateUpdated":"2018-07-28T15:28:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(278716, 1558), (1387683, 324), (639095, 1192), (240681, 646), (31895, 969)]\n"}]},"apps":[],"jobName":"paragraph_1532784707371_-143814264","id":"20180728-133147_522047473","dateCreated":"2018-07-28T13:31:47+0000","dateStarted":"2018-07-28T15:28:05+0000","dateFinished":"2018-07-28T15:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:160"},{"text":"%spark2.pyspark\n# Making predictions\n\npred_ind = model.predict(31895, 969)\n\npred_ind","user":"anonymous","dateUpdated":"2018-07-28T15:28:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.010171848679720511\n"}]},"apps":[],"jobName":"paragraph_1532784737529_1482934734","id":"20180728-133217_1157377500","dateCreated":"2018-07-28T13:32:17+0000","dateStarted":"2018-07-28T15:28:33+0000","dateFinished":"2018-07-28T15:28:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:161"},{"text":"%spark2.pyspark\npredictions = model.predictAll(testdata).map(lambda r: ((r[0], r[1]),r[2]))\n\npredictions.take(5)\n","user":"anonymous","dateUpdated":"2018-07-28T15:29:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[((129434, 248), 0.0010244889263887778), ((1393130, 320), 0.00045424169227544913), ((637370, 924), 0.0001609029685380086), ((324206, 730), 0.008581448170246865), ((1167720, 532), 0.0002439474415590689)]\n"}]},"apps":[],"jobName":"paragraph_1532784763076_-1311249696","id":"20180728-133243_720908994","dateCreated":"2018-07-28T13:32:43+0000","dateStarted":"2018-07-28T15:29:09+0000","dateFinished":"2018-07-28T15:29:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:162"},{"text":"%spark2.pyspark\ntype(predictions)","user":"anonymous","dateUpdated":"2018-07-28T15:30:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n"}]},"apps":[],"jobName":"paragraph_1532784802676_1176197915","id":"20180728-133322_364798369","dateCreated":"2018-07-28T13:33:22+0000","dateStarted":"2018-07-28T15:30:49+0000","dateFinished":"2018-07-28T15:30:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:163"},{"text":"%spark2.pyspark\n# Recommend Products(category) For Users method to generate the top N item recommendations for users\n\nrecommendItemsToUsers = predictions.recommendProductsForUsers(10)\nrecommendItemsToUsers.take(1)","user":"anonymous","dateUpdated":"2018-07-28T16:11:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784779594_1023437278","id":"20180728-133259_549024954","dateCreated":"2018-07-28T13:32:59+0000","dateStarted":"2018-07-28T16:11:39+0000","dateFinished":"2018-07-28T16:55:20+0000","status":"RUNNING","progressUpdateIntervalMs":500,"$$hashKey":"object:164"},{"text":"%spark2.pyspark\n#Category\n\nrecommendItemsToUsers.count()","user":"anonymous","dateUpdated":"2018-07-28T16:11:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1011459\n"}]},"apps":[],"jobName":"paragraph_1532784799421_-821803123","id":"20180728-133319_381155180","dateCreated":"2018-07-28T13:33:19+0000","dateStarted":"2018-07-28T15:39:47+0000","dateFinished":"2018-07-28T15:41:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165"},{"text":"%spark2.pyspark\nfirst_user = model.userFeatures().take(1)[0]\nlatents = first_user[1]\nlen(latents)","user":"anonymous","dateUpdated":"2018-07-28T15:51:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"10\n"}]},"apps":[],"jobName":"paragraph_1532792664761_-1192882858","id":"20180728-154424_506293669","dateCreated":"2018-07-28T15:44:24+0000","dateStarted":"2018-07-28T15:51:49+0000","dateFinished":"2018-07-28T15:51:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"text":"%spark2.pyspark\n# Calculate rmse\nfrom math import sqrt\n\nratesAndPreds = CatRating.map(lambda r: ((r[0],r[1]), r[2])).join(predictions)","user":"anonymous","dateUpdated":"2018-07-28T13:34:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784851483_-1583393051","id":"20180728-133411_306425298","dateCreated":"2018-07-28T13:34:11+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:167"},{"text":"%spark2.pyspark\nratesAndPreds.take(5)","user":"anonymous","dateUpdated":"2018-07-28T13:34:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784866356_-293299341","id":"20180728-133426_1467974890","dateCreated":"2018-07-28T13:34:26+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:168"},{"text":"%spark2.pyspark\nMSE = ratesAndPreds.map(lambda r: (r[1][0]-r[1][1])**2).mean()\n\nprint(\"MeanSquareError = \" + str(MSE))","user":"anonymous","dateUpdated":"2018-07-28T13:34:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784856596_1885918429","id":"20180728-133416_883081221","dateCreated":"2018-07-28T13:34:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:169"},{"text":"%spark2.pyspark\n# Root Mean Square Error\n\nrmse = sqrt(MSE)\n\nprint(\"Root_Mean_Square_Error = \" + str(rmse))\n","user":"anonymous","dateUpdated":"2018-07-28T13:35:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784908180_-19480717","id":"20180728-133508_725341089","dateCreated":"2018-07-28T13:35:08+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:170"},{"text":"%spark2.pyspark\n# 2.  Model Evluation and Selection with Hyper Parameter Tuning\n\ndf = sqlContext.createDataFrame(CatRating)\n\ntype(df)","user":"anonymous","dateUpdated":"2018-07-28T13:35:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784904184_-1633887102","id":"20180728-133504_547184969","dateCreated":"2018-07-28T13:35:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:171"},{"text":"%spark2.pyspark\ndf.show(5)","user":"anonymous","dateUpdated":"2018-07-28T13:35:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784900984_-68359152","id":"20180728-133500_796762287","dateCreated":"2018-07-28T13:35:00+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:172"},{"text":"%spark2.pyspark\n# Split the input data into training and test datasets\n\n(training, test) = df.randomSplit([0.8,0.2])","user":"anonymous","dateUpdated":"2018-07-28T13:35:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784896804_-1624283704","id":"20180728-133456_1779974089","dateCreated":"2018-07-28T13:34:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:173"},{"text":"%spark2.pyspark\n# Apply implicit parameter to the data\n\nfrom pyspark.ml.recommendation import ALS\n\nals = ALS(implicitPrefs=True, userCol=\"user\", itemCol=\"product\", ratingCol=\"rating\", coldStartStrategy=\"drop\")\n\nals","user":"anonymous","dateUpdated":"2018-07-28T13:36:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784964204_-1517415455","id":"20180728-133604_246414466","dateCreated":"2018-07-28T13:36:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174"},{"text":"%spark2.pyspark\nals.explainParams()\n","user":"anonymous","dateUpdated":"2018-07-28T13:36:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784960776_1141599518","id":"20180728-133600_1820627954","dateCreated":"2018-07-28T13:36:00+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:175"},{"text":"%spark2.pyspark\nfrom pyspark.ml import Pipeline\n\npipeline = Pipeline(stages=[als])\n","user":"anonymous","dateUpdated":"2018-07-28T13:36:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784957893_-1512813792","id":"20180728-133557_104688551","dateCreated":"2018-07-28T13:35:57+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:176"},{"text":"%spark2.pyspark\n# Set the params\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\n\nparamImplicit = ParamGridBuilder()\\\n.addGrid(als.rank,[5,10])\\\n.addGrid(als.maxIter,[5,10])\\\n.addGrid(als.regParam,[1.0,5.0])\\\n.build()","user":"anonymous","dateUpdated":"2018-07-28T13:37:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532784953045_-265057785","id":"20180728-133553_1101518539","dateCreated":"2018-07-28T13:35:53+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:177"},{"text":"%spark2.pyspark\nfrom pyspark.ml.evaluation import RegressionEvaluator\n\nevaluatoR = RegressionEvaluator(metricName='rmse', labelCol='rating')","user":"anonymous","dateUpdated":"2018-07-28T13:37:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785061619_1378558868","id":"20180728-133741_1067667844","dateCreated":"2018-07-28T13:37:41+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:178"},{"text":"%spark2.pyspark\n# Fit the estimator using params\n\ncvImplicit = CrossValidator(estimator=als, estimatorParamMaps=paramImplicit, evaluator=evaluatoR, numFolds=3)\n","user":"anonymous","dateUpdated":"2018-07-28T13:38:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785058907_747570672","id":"20180728-133738_1471660694","dateCreated":"2018-07-28T13:37:38+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:179"},{"text":"%spark2.pyspark\ncvModel = cvImplicit.fit(training)","user":"anonymous","dateUpdated":"2018-07-28T13:38:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785056087_-1832586100","id":"20180728-133736_1765504177","dateCreated":"2018-07-28T13:37:36+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:180"},{"text":"%spark2.pyspark\n# Fit the model\n\n# Select the model produced by the best performance set of params\n\npreds = cvModel.bestModel.transform(test)\n","user":"anonymous","dateUpdated":"2018-07-28T13:38:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785101303_-1773491301","id":"20180728-133821_14423007","dateCreated":"2018-07-28T13:38:21+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:181"},{"text":"%spark2.pyspark\nevaluator = RegressionEvaluator(metricName='rmse', labelCol='rating', predictionCol='prediction')","user":"anonymous","dateUpdated":"2018-07-28T13:38:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785106829_-761601693","id":"20180728-133826_520352198","dateCreated":"2018-07-28T13:38:26+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:182"},{"text":"%spark2.pyspark\n# Find Root Mean Square Error\n\nrmse = evaluator.evaluate(preds)\n\nprint(\"Root_mean_square error = \") + str(rmse)","user":"anonymous","dateUpdated":"2018-07-28T13:39:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1532785134540_1494828012","id":"20180728-133854_1963445329","dateCreated":"2018-07-28T13:38:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:183"}],"name":"CategoryWiseRecs","id":"2DNUBUBAF","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}